<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<!--
    Copyright (C) 2006-2025 Carnegie Mellon University
    See license information in LICENSE.txt.
-->
<!--
    @DISTRIBUTION_STATEMENT_BEGIN@
    YAF 2.16
    Copyright 2024 Carnegie Mellon University.
    NO WARRANTY. THIS CARNEGIE MELLON UNIVERSITY AND SOFTWARE ENGINEERING
    INSTITUTE MATERIAL IS FURNISHED ON AN "AS-IS" BASIS. CARNEGIE MELLON
    UNIVERSITY MAKES NO WARRANTIES OF ANY KIND, EITHER EXPRESSED OR IMPLIED,
    AS TO ANY MATTER INCLUDING, BUT NOT LIMITED TO, WARRANTY OF FITNESS FOR
    PURPOSE OR MERCHANTABILITY, EXCLUSIVITY, OR RESULTS OBTAINED FROM USE OF
    THE MATERIAL. CARNEGIE MELLON UNIVERSITY DOES NOT MAKE ANY WARRANTY OF
    ANY KIND WITH RESPECT TO FREEDOM FROM PATENT, TRADEMARK, OR COPYRIGHT
    INFRINGEMENT.
    Licensed under a GNU GPL 2.0-style license, please see LICENSE.txt or
    contact permission@sei.cmu.edu for full terms.
    [DISTRIBUTION STATEMENT A] This material has been approved for public
    release and unlimited distribution.  Please see Copyright notice for
    non-US Government use and distribution.
    This Software includes and/or makes use of Third-Party Software each
    subject to its own license.
    DM24-1063
    @DISTRIBUTION_STATEMENT_END@
-->
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>YAF: yaftime.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Tutorials</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_6b37a46a393f56ebfde52363f14c7b66.html">yaf-2.16.3</a></li><li class="navelem"><a class="el" href="dir_fafcf9195e8860f2dff6bcc13283923c.html">include</a></li><li class="navelem"><a class="el" href="dir_b0708b8b1bebb07de093b1485da11eea.html">yaf</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="headertitle"><div class="title">yaftime.h</div></div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a id="l00001"></a><span class="lineno">    1</span><span class="comment">/*</span></div>
<div class="line"><a id="l00002"></a><span class="lineno">    2</span><span class="comment"> *  Copyright 2024 Carnegie Mellon University</span></div>
<div class="line"><a id="l00003"></a><span class="lineno">    3</span><span class="comment"> *  See license information in LICENSE.txt.</span></div>
<div class="line"><a id="l00004"></a><span class="lineno">    4</span><span class="comment"> */</span></div>
<div class="line"><a id="l00005"></a><span class="lineno">    5</span><span class="comment">/*</span></div>
<div class="line"><a id="l00006"></a><span class="lineno">    6</span><span class="comment"> *  yaftime.h</span></div>
<div class="line"><a id="l00007"></a><span class="lineno">    7</span><span class="comment"> *</span></div>
<div class="line"><a id="l00008"></a><span class="lineno">    8</span><span class="comment"> *  Types, functions, and macros for holding and manipluating timestamps and</span></div>
<div class="line"><a id="l00009"></a><span class="lineno">    9</span><span class="comment"> *  time-differences.</span></div>
<div class="line"><a id="l00010"></a><span class="lineno">   10</span><span class="comment"> *</span></div>
<div class="line"><a id="l00011"></a><span class="lineno">   11</span><span class="comment"> *  ------------------------------------------------------------------------</span></div>
<div class="line"><a id="l00012"></a><span class="lineno">   12</span><span class="comment"> *  @DISTRIBUTION_STATEMENT_BEGIN@</span></div>
<div class="line"><a id="l00013"></a><span class="lineno">   13</span><span class="comment"> *  YAF 2.16</span></div>
<div class="line"><a id="l00014"></a><span class="lineno">   14</span><span class="comment"> *</span></div>
<div class="line"><a id="l00015"></a><span class="lineno">   15</span><span class="comment"> *  Copyright 2024 Carnegie Mellon University.</span></div>
<div class="line"><a id="l00016"></a><span class="lineno">   16</span><span class="comment"> *</span></div>
<div class="line"><a id="l00017"></a><span class="lineno">   17</span><span class="comment"> *  NO WARRANTY. THIS CARNEGIE MELLON UNIVERSITY AND SOFTWARE ENGINEERING</span></div>
<div class="line"><a id="l00018"></a><span class="lineno">   18</span><span class="comment"> *  INSTITUTE MATERIAL IS FURNISHED ON AN &quot;AS-IS&quot; BASIS. CARNEGIE MELLON</span></div>
<div class="line"><a id="l00019"></a><span class="lineno">   19</span><span class="comment"> *  UNIVERSITY MAKES NO WARRANTIES OF ANY KIND, EITHER EXPRESSED OR IMPLIED,</span></div>
<div class="line"><a id="l00020"></a><span class="lineno">   20</span><span class="comment"> *  AS TO ANY MATTER INCLUDING, BUT NOT LIMITED TO, WARRANTY OF FITNESS FOR</span></div>
<div class="line"><a id="l00021"></a><span class="lineno">   21</span><span class="comment"> *  PURPOSE OR MERCHANTABILITY, EXCLUSIVITY, OR RESULTS OBTAINED FROM USE OF</span></div>
<div class="line"><a id="l00022"></a><span class="lineno">   22</span><span class="comment"> *  THE MATERIAL. CARNEGIE MELLON UNIVERSITY DOES NOT MAKE ANY WARRANTY OF</span></div>
<div class="line"><a id="l00023"></a><span class="lineno">   23</span><span class="comment"> *  ANY KIND WITH RESPECT TO FREEDOM FROM PATENT, TRADEMARK, OR COPYRIGHT</span></div>
<div class="line"><a id="l00024"></a><span class="lineno">   24</span><span class="comment"> *  INFRINGEMENT.</span></div>
<div class="line"><a id="l00025"></a><span class="lineno">   25</span><span class="comment"> *</span></div>
<div class="line"><a id="l00026"></a><span class="lineno">   26</span><span class="comment"> *  Licensed under a GNU GPL 2.0-style license, please see LICENSE.txt or</span></div>
<div class="line"><a id="l00027"></a><span class="lineno">   27</span><span class="comment"> *  contact permission@sei.cmu.edu for full terms.</span></div>
<div class="line"><a id="l00028"></a><span class="lineno">   28</span><span class="comment"> *</span></div>
<div class="line"><a id="l00029"></a><span class="lineno">   29</span><span class="comment"> *  [DISTRIBUTION STATEMENT A] This material has been approved for public</span></div>
<div class="line"><a id="l00030"></a><span class="lineno">   30</span><span class="comment"> *  release and unlimited distribution.  Please see Copyright notice for</span></div>
<div class="line"><a id="l00031"></a><span class="lineno">   31</span><span class="comment"> *  non-US Government use and distribution.</span></div>
<div class="line"><a id="l00032"></a><span class="lineno">   32</span><span class="comment"> *</span></div>
<div class="line"><a id="l00033"></a><span class="lineno">   33</span><span class="comment"> *  This Software includes and/or makes use of Third-Party Software each</span></div>
<div class="line"><a id="l00034"></a><span class="lineno">   34</span><span class="comment"> *  subject to its own license.</span></div>
<div class="line"><a id="l00035"></a><span class="lineno">   35</span><span class="comment"> *</span></div>
<div class="line"><a id="l00036"></a><span class="lineno">   36</span><span class="comment"> *  DM24-1063</span></div>
<div class="line"><a id="l00037"></a><span class="lineno">   37</span><span class="comment"> *  @DISTRIBUTION_STATEMENT_END@</span></div>
<div class="line"><a id="l00038"></a><span class="lineno">   38</span><span class="comment"> *  ------------------------------------------------------------------------</span></div>
<div class="line"><a id="l00039"></a><span class="lineno">   39</span><span class="comment"> */</span></div>
<div class="line"><a id="l00040"></a><span class="lineno">   40</span><span class="preprocessor">#ifndef _YAF_TIME_H_</span></div>
<div class="line"><a id="l00041"></a><span class="lineno">   41</span><span class="preprocessor">#define _YAF_TIME_H_</span></div>
<div class="line"><a id="l00042"></a><span class="lineno">   42</span> </div>
<div class="line"><a id="l00043"></a><span class="lineno">   43</span> </div>
<div class="foldopen" id="foldopen00047" data-start="{" data-end="};">
<div class="line"><a id="l00047"></a><span class="lineno"><a class="line" href="structyf_time__st.html">   47</a></span><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code hl_struct" href="structyf_time__st.html">yfTime_st</a> {</div>
<div class="line"><a id="l00048"></a><span class="lineno">   48</span>    <span class="comment">/* Epoch nanoseconds.  Valid until 2554-07-21 */</span></div>
<div class="line"><a id="l00049"></a><span class="lineno">   49</span>    uint64_t  t;</div>
<div class="line"><a id="l00050"></a><span class="lineno">   50</span>} <a class="code hl_struct" href="structyf_time__st.html">yfTime_t</a>;</div>
</div>
<div class="line"><a id="l00051"></a><span class="lineno">   51</span> </div>
<div class="foldopen" id="foldopen00055" data-start="{" data-end="};">
<div class="line"><a id="l00055"></a><span class="lineno"><a class="line" href="structyf_diff_time__st.html">   55</a></span><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code hl_struct" href="structyf_diff_time__st.html">yfDiffTime_st</a> {</div>
<div class="line"><a id="l00056"></a><span class="lineno">   56</span>    <span class="comment">/* Nanosecond difference */</span></div>
<div class="line"><a id="l00057"></a><span class="lineno">   57</span>    int64_t   d;</div>
<div class="line"><a id="l00058"></a><span class="lineno">   58</span>} <a class="code hl_struct" href="structyf_diff_time__st.html">yfDiffTime_t</a>;</div>
</div>
<div class="line"><a id="l00059"></a><span class="lineno">   59</span> </div>
<div class="foldopen" id="foldopen00066" data-start="{" data-end="};">
<div class="line"><a id="l00066"></a><span class="lineno"><a class="line" href="structyf__timespec32__st.html">   66</a></span><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code hl_struct" href="structyf__timespec32__st.html">yf_timespec32_st</a> {</div>
<div class="line"><a id="l00067"></a><span class="lineno">   67</span>    uint32_t  tv_sec;</div>
<div class="line"><a id="l00068"></a><span class="lineno">   68</span>    uint32_t  tv_frac;</div>
<div class="line"><a id="l00069"></a><span class="lineno">   69</span>} <a class="code hl_struct" href="structyf__timespec32__st.html">yf_timespec32_t</a>;</div>
</div>
<div class="line"><a id="l00070"></a><span class="lineno">   70</span> </div>
<div class="foldopen" id="foldopen00075" data-start="{" data-end="};">
<div class="line"><a id="l00075"></a><span class="lineno"><a class="line" href="structyf__time__milli__st.html">   75</a></span><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code hl_struct" href="structyf__time__milli__st.html">yf_time_milli_st</a> {</div>
<div class="line"><a id="l00076"></a><span class="lineno">   76</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span>  tv_sec;</div>
<div class="line"><a id="l00077"></a><span class="lineno">   77</span>    <span class="keywordtype">long</span>       tv_msec;</div>
<div class="line"><a id="l00078"></a><span class="lineno">   78</span>} <a class="code hl_struct" href="structyf__time__milli__st.html">yf_time_milli_t</a>;</div>
</div>
<div class="line"><a id="l00079"></a><span class="lineno">   79</span> </div>
<div class="line"><a id="l00090"></a><span class="lineno">   90</span><span class="preprocessor">#define YF_TIME_NTP_USEC_MASK  UINT64_C(0xfffffffffffff800)</span></div>
<div class="line"><a id="l00091"></a><span class="lineno">   91</span> </div>
<div class="line"><a id="l00095"></a><span class="lineno">   95</span><span class="preprocessor">#define YF_TIME_INIT      { 0 }</span></div>
<div class="line"><a id="l00096"></a><span class="lineno">   96</span> </div>
<div class="line"><a id="l00100"></a><span class="lineno">  100</span><span class="preprocessor">#define YF_DIFFTIME_INIT  { 0 }</span></div>
<div class="line"><a id="l00101"></a><span class="lineno">  101</span> </div>
<div class="line"><a id="l00106"></a><span class="lineno">  106</span><span class="preprocessor">#define YF_DIFFTIME_INIT_MILLI(ms_)  { INT64_C(1000000) * (ms_) }</span></div>
<div class="line"><a id="l00107"></a><span class="lineno">  107</span> </div>
<div class="line"><a id="l00111"></a><span class="lineno">  111</span><span class="keyword">static</span> <span class="keyword">const</span> <a class="code hl_struct" href="structyf_time__st.html">yfTime_t</a> yfTimeZeroConstant = YF_TIME_INIT;</div>
<div class="line"><a id="l00112"></a><span class="lineno">  112</span> </div>
<div class="line"><a id="l00116"></a><span class="lineno">  116</span><span class="keyword">static</span> <span class="keyword">const</span> <a class="code hl_struct" href="structyf_diff_time__st.html">yfDiffTime_t</a> yfDiffTimeZeroConstant = YF_DIFFTIME_INIT;</div>
<div class="line"><a id="l00117"></a><span class="lineno">  117</span> </div>
<div class="line"><a id="l00118"></a><span class="lineno">  118</span> </div>
<div class="line"><a id="l00119"></a><span class="lineno">  119</span> </div>
<div class="line"><a id="l00120"></a><span class="lineno">  120</span><span class="comment">/*</span></div>
<div class="line"><a id="l00121"></a><span class="lineno">  121</span><span class="comment"> *    Note: If we are going to continue to use functions below (instead of</span></div>
<div class="line"><a id="l00122"></a><span class="lineno">  122</span><span class="comment"> *    changing them to macros), it would make sense for the return type to be</span></div>
<div class="line"><a id="l00123"></a><span class="lineno">  123</span><span class="comment"> *    the yfTime_t* that was passed in.  Doing this would allow these function</span></div>
<div class="line"><a id="l00124"></a><span class="lineno">  124</span><span class="comment"> *    calls to appear in other function calls.</span></div>
<div class="line"><a id="l00125"></a><span class="lineno">  125</span><span class="comment"> */</span></div>
<div class="line"><a id="l00126"></a><span class="lineno">  126</span> </div>
<div class="line"><a id="l00127"></a><span class="lineno">  127</span> </div>
<div class="line"><a id="l00128"></a><span class="lineno">  128</span> </div>
<div class="line"><a id="l00129"></a><span class="lineno">  129</span><span class="comment">/*</span></div>
<div class="line"><a id="l00130"></a><span class="lineno">  130</span><span class="comment"> *    *********************************************************************</span></div>
<div class="line"><a id="l00131"></a><span class="lineno">  131</span><span class="comment"> *</span></div>
<div class="line"><a id="l00132"></a><span class="lineno">  132</span><span class="comment"> *    Functions and Macros for yfTime_t</span></div>
<div class="line"><a id="l00133"></a><span class="lineno">  133</span><span class="comment"> *</span></div>
<div class="line"><a id="l00134"></a><span class="lineno">  134</span><span class="comment"> *    *********************************************************************</span></div>
<div class="line"><a id="l00135"></a><span class="lineno">  135</span><span class="comment"> */</span></div>
<div class="line"><a id="l00136"></a><span class="lineno">  136</span> </div>
<div class="line"><a id="l00140"></a><span class="lineno">  140</span><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line"><a id="l00141"></a><span class="lineno">  141</span>yfTimeClear(</div>
<div class="line"><a id="l00142"></a><span class="lineno">  142</span>    <a class="code hl_struct" href="structyf_time__st.html">yfTime_t</a>  *yftime)</div>
<div class="line"><a id="l00143"></a><span class="lineno">  143</span>{</div>
<div class="line"><a id="l00144"></a><span class="lineno">  144</span>    yftime-&gt;t = 0;</div>
<div class="line"><a id="l00145"></a><span class="lineno">  145</span>}</div>
<div class="line"><a id="l00146"></a><span class="lineno">  146</span> </div>
<div class="line"><a id="l00151"></a><span class="lineno">  151</span><span class="keyword">static</span> <span class="keyword">inline</span> gboolean</div>
<div class="line"><a id="l00152"></a><span class="lineno">  152</span>yfTimeIsSet(</div>
<div class="line"><a id="l00153"></a><span class="lineno">  153</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structyf_time__st.html">yfTime_t</a>  yftime)</div>
<div class="line"><a id="l00154"></a><span class="lineno">  154</span>{</div>
<div class="line"><a id="l00155"></a><span class="lineno">  155</span>    <span class="keywordflow">return</span> (0 != yftime.t);</div>
<div class="line"><a id="l00156"></a><span class="lineno">  156</span>}</div>
<div class="line"><a id="l00157"></a><span class="lineno">  157</span> </div>
<div class="line"><a id="l00164"></a><span class="lineno">  164</span><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line"><a id="l00165"></a><span class="lineno">  165</span>yfTimeAdd(</div>
<div class="line"><a id="l00166"></a><span class="lineno">  166</span>    <a class="code hl_struct" href="structyf_time__st.html">yfTime_t</a>            *yftime_new,</div>
<div class="line"><a id="l00167"></a><span class="lineno">  167</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structyf_time__st.html">yfTime_t</a>       yftime_old,</div>
<div class="line"><a id="l00168"></a><span class="lineno">  168</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structyf_diff_time__st.html">yfDiffTime_t</a>   yfdifftime)</div>
<div class="line"><a id="l00169"></a><span class="lineno">  169</span>{</div>
<div class="line"><a id="l00170"></a><span class="lineno">  170</span>    yftime_new-&gt;t = yftime_old.t + yfdifftime.d;</div>
<div class="line"><a id="l00171"></a><span class="lineno">  171</span>}</div>
<div class="line"><a id="l00172"></a><span class="lineno">  172</span> </div>
<div class="line"><a id="l00179"></a><span class="lineno">  179</span><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line"><a id="l00180"></a><span class="lineno">  180</span>yfTimeSub(</div>
<div class="line"><a id="l00181"></a><span class="lineno">  181</span>    <a class="code hl_struct" href="structyf_time__st.html">yfTime_t</a>            *yftime_new,</div>
<div class="line"><a id="l00182"></a><span class="lineno">  182</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structyf_time__st.html">yfTime_t</a>       yftime_old,</div>
<div class="line"><a id="l00183"></a><span class="lineno">  183</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structyf_diff_time__st.html">yfDiffTime_t</a>   yfdifftime)</div>
<div class="line"><a id="l00184"></a><span class="lineno">  184</span>{</div>
<div class="line"><a id="l00185"></a><span class="lineno">  185</span>    yftime_new-&gt;t = yftime_old.t - yfdifftime.d;</div>
<div class="line"><a id="l00186"></a><span class="lineno">  186</span>}</div>
<div class="line"><a id="l00187"></a><span class="lineno">  187</span> </div>
<div class="line"><a id="l00197"></a><span class="lineno">  197</span><span class="preprocessor">#define yfTimeCmpOp(yftime_a, yftime_b, oper_)  \</span></div>
<div class="line"><a id="l00198"></a><span class="lineno">  198</span><span class="preprocessor">    ((yftime_a).t oper_ (yftime_b).t)</span></div>
<div class="line"><a id="l00199"></a><span class="lineno">  199</span> </div>
<div class="line"><a id="l00208"></a><span class="lineno">  208</span><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span></div>
<div class="line"><a id="l00209"></a><span class="lineno">  209</span>yfTimeCompare(</div>
<div class="line"><a id="l00210"></a><span class="lineno">  210</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structyf_time__st.html">yfTime_t</a>  yftime_a,</div>
<div class="line"><a id="l00211"></a><span class="lineno">  211</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structyf_time__st.html">yfTime_t</a>  yftime_b)</div>
<div class="line"><a id="l00212"></a><span class="lineno">  212</span>{</div>
<div class="line"><a id="l00213"></a><span class="lineno">  213</span>    <span class="keywordflow">return</span> ((yftime_a.t &lt; yftime_b.t) ? -1 : (yftime_a.t &gt; yftime_b.t));</div>
<div class="line"><a id="l00214"></a><span class="lineno">  214</span>}</div>
<div class="line"><a id="l00215"></a><span class="lineno">  215</span> </div>
<div class="line"><a id="l00222"></a><span class="lineno">  222</span><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line"><a id="l00223"></a><span class="lineno">  223</span>yfTimeDifference(</div>
<div class="line"><a id="l00224"></a><span class="lineno">  224</span>    <a class="code hl_struct" href="structyf_diff_time__st.html">yfDiffTime_t</a>     *yfdiff,</div>
<div class="line"><a id="l00225"></a><span class="lineno">  225</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structyf_time__st.html">yfTime_t</a>    yftime_end,</div>
<div class="line"><a id="l00226"></a><span class="lineno">  226</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structyf_time__st.html">yfTime_t</a>    yftime_start)</div>
<div class="line"><a id="l00227"></a><span class="lineno">  227</span>{</div>
<div class="line"><a id="l00228"></a><span class="lineno">  228</span>    yfdiff-&gt;d = yftime_end.t - yftime_start.t;</div>
<div class="line"><a id="l00229"></a><span class="lineno">  229</span>}</div>
<div class="line"><a id="l00230"></a><span class="lineno">  230</span> </div>
<div class="line"><a id="l00235"></a><span class="lineno">  235</span><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line"><a id="l00236"></a><span class="lineno">  236</span>yfTimeFromMicro(</div>
<div class="line"><a id="l00237"></a><span class="lineno">  237</span>    <a class="code hl_struct" href="structyf_time__st.html">yfTime_t</a>       *yftime,</div>
<div class="line"><a id="l00238"></a><span class="lineno">  238</span>    <span class="keyword">const</span> uint64_t  epoch_usec)</div>
<div class="line"><a id="l00239"></a><span class="lineno">  239</span>{</div>
<div class="line"><a id="l00240"></a><span class="lineno">  240</span>    yftime-&gt;t = UINT64_C(1000) * epoch_usec;</div>
<div class="line"><a id="l00241"></a><span class="lineno">  241</span>}</div>
<div class="line"><a id="l00242"></a><span class="lineno">  242</span> </div>
<div class="line"><a id="l00247"></a><span class="lineno">  247</span><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line"><a id="l00248"></a><span class="lineno">  248</span>yfTimeFromMilli(</div>
<div class="line"><a id="l00249"></a><span class="lineno">  249</span>    <a class="code hl_struct" href="structyf_time__st.html">yfTime_t</a>       *yftime,</div>
<div class="line"><a id="l00250"></a><span class="lineno">  250</span>    <span class="keyword">const</span> uint64_t  epoch_msec)</div>
<div class="line"><a id="l00251"></a><span class="lineno">  251</span>{</div>
<div class="line"><a id="l00252"></a><span class="lineno">  252</span>    yftime-&gt;t = UINT64_C(1000000) * epoch_msec;</div>
<div class="line"><a id="l00253"></a><span class="lineno">  253</span>}</div>
<div class="line"><a id="l00254"></a><span class="lineno">  254</span> </div>
<div class="line"><a id="l00259"></a><span class="lineno">  259</span><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line"><a id="l00260"></a><span class="lineno">  260</span>yfTimeFromNano(</div>
<div class="line"><a id="l00261"></a><span class="lineno">  261</span>    <a class="code hl_struct" href="structyf_time__st.html">yfTime_t</a>       *yftime,</div>
<div class="line"><a id="l00262"></a><span class="lineno">  262</span>    <span class="keyword">const</span> uint64_t  epoch_nsec)</div>
<div class="line"><a id="l00263"></a><span class="lineno">  263</span>{</div>
<div class="line"><a id="l00264"></a><span class="lineno">  264</span>    yftime-&gt;t = epoch_nsec;</div>
<div class="line"><a id="l00265"></a><span class="lineno">  265</span>}</div>
<div class="line"><a id="l00266"></a><span class="lineno">  266</span> </div>
<div class="line"><a id="l00272"></a><span class="lineno">  272</span><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line"><a id="l00273"></a><span class="lineno">  273</span>yfTimeFromNTP(</div>
<div class="line"><a id="l00274"></a><span class="lineno">  274</span>    <a class="code hl_struct" href="structyf_time__st.html">yfTime_t</a>       *yftime,</div>
<div class="line"><a id="l00275"></a><span class="lineno">  275</span>    <span class="keyword">const</span> uint64_t  ntp,</div>
<div class="line"><a id="l00276"></a><span class="lineno">  276</span>    gboolean        is_micro)</div>
<div class="line"><a id="l00277"></a><span class="lineno">  277</span>{</div>
<div class="line"><a id="l00278"></a><span class="lineno">  278</span>    <span class="comment">/* The number of seconds between the NTP epoch (Jan 1, 1900) and the UNIX</span></div>
<div class="line"><a id="l00279"></a><span class="lineno">  279</span><span class="comment">     * epoch (Jan 1, 1970).  Seventy 365-day years plus 17 leap days, at 86400</span></div>
<div class="line"><a id="l00280"></a><span class="lineno">  280</span><span class="comment">     * sec/day: ((70 * 365 + 17) * 86400) */</span></div>
<div class="line"><a id="l00281"></a><span class="lineno">  281</span>    <span class="keyword">const</span> uint64_t NTP_EPOCH_TO_UNIX_EPOCH = UINT64_C(0x83AA7E80);</div>
<div class="line"><a id="l00282"></a><span class="lineno">  282</span> </div>
<div class="line"><a id="l00283"></a><span class="lineno">  283</span>    <span class="comment">/* use all lower 32 bits for the Nanosecond mask */</span></div>
<div class="line"><a id="l00284"></a><span class="lineno">  284</span>    <span class="keyword">const</span> uint64_t NANO_MASK      = UINT64_C(0xffffffff);</div>
<div class="line"><a id="l00285"></a><span class="lineno">  285</span>    <span class="comment">/* nanoseconds per whole second, 1e9 */</span></div>
<div class="line"><a id="l00286"></a><span class="lineno">  286</span>    <span class="keyword">const</span> uint64_t NANO_PER_SEC   = UINT64_C(1000000000);</div>
<div class="line"><a id="l00287"></a><span class="lineno">  287</span> </div>
<div class="line"><a id="l00288"></a><span class="lineno">  288</span>    <span class="comment">/* IETF says the Microsecond mask must ignore the lowest 11 bits */</span></div>
<div class="line"><a id="l00289"></a><span class="lineno">  289</span>    <span class="keyword">const</span> uint64_t MICRO_MASK     = UINT64_C(0xfffff800);</div>
<div class="line"><a id="l00290"></a><span class="lineno">  290</span>    <span class="comment">/* microseconds per whole second, 1e6 */</span></div>
<div class="line"><a id="l00291"></a><span class="lineno">  291</span>    <span class="keyword">const</span> uint64_t MICRO_PER_SEC  = UINT64_C(1000000);</div>
<div class="line"><a id="l00292"></a><span class="lineno">  292</span> </div>
<div class="line"><a id="l00293"></a><span class="lineno">  293</span>    <span class="comment">/* When the NTP value rolls over in 2036, must add 2^32 seconds to the</span></div>
<div class="line"><a id="l00294"></a><span class="lineno">  294</span><span class="comment">     * UNIX time */</span></div>
<div class="line"><a id="l00295"></a><span class="lineno">  295</span>    <span class="keyword">const</span> uint64_t NTP_ROLLOVER = UINT64_C(0x100000000);</div>
<div class="line"><a id="l00296"></a><span class="lineno">  296</span> </div>
<div class="line"><a id="l00297"></a><span class="lineno">  297</span>    <span class="comment">/* To get a proper value when converting to fractional seconds, add 1&lt;&lt;31</span></div>
<div class="line"><a id="l00298"></a><span class="lineno">  298</span><span class="comment">     * before the &gt;&gt;32 to round up values.  Not doing so introduces errors</span></div>
<div class="line"><a id="l00299"></a><span class="lineno">  299</span><span class="comment">     * that can accumulate with repeated conversions. */</span></div>
<div class="line"><a id="l00300"></a><span class="lineno">  300</span>    <span class="keyword">const</span> uint64_t ROUNDING_DIFF = UINT64_C(0x80000000);</div>
<div class="line"><a id="l00301"></a><span class="lineno">  301</span> </div>
<div class="line"><a id="l00302"></a><span class="lineno">  302</span>    <span class="comment">/* Handle fractional seconds */</span></div>
<div class="line"><a id="l00303"></a><span class="lineno">  303</span>    <span class="keywordflow">if</span> (!is_micro) {</div>
<div class="line"><a id="l00304"></a><span class="lineno">  304</span>        <span class="comment">/* Mask the lower 32 bits of `ntp` to get the fractional second part.</span></div>
<div class="line"><a id="l00305"></a><span class="lineno">  305</span><span class="comment">         * Divide by 2^32 to get a floating point number that is a fraction of</span></div>
<div class="line"><a id="l00306"></a><span class="lineno">  306</span><span class="comment">         * a second, and multiply by NANO_PER_SEC to get nanoeconds, but do</span></div>
<div class="line"><a id="l00307"></a><span class="lineno">  307</span><span class="comment">         * those in reverse order, use shift for the division, and handle</span></div>
<div class="line"><a id="l00308"></a><span class="lineno">  308</span><span class="comment">         * rounding before the division */</span></div>
<div class="line"><a id="l00309"></a><span class="lineno">  309</span>        yftime-&gt;t = ((ntp &amp; NANO_MASK) * NANO_PER_SEC + ROUNDING_DIFF) &gt;&gt; 32;</div>
<div class="line"><a id="l00310"></a><span class="lineno">  310</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00311"></a><span class="lineno">  311</span>        <span class="comment">/* Do something similar as for nanoseconds but using microseconds,</span></div>
<div class="line"><a id="l00312"></a><span class="lineno">  312</span><span class="comment">         * then multiply by 1000 at the end to get nanoseconds as a whole</span></div>
<div class="line"><a id="l00313"></a><span class="lineno">  313</span><span class="comment">         * number of microseconds */</span></div>
<div class="line"><a id="l00314"></a><span class="lineno">  314</span>        yftime-&gt;t = ((((ntp &amp; MICRO_MASK) * MICRO_PER_SEC + ROUNDING_DIFF)</div>
<div class="line"><a id="l00315"></a><span class="lineno">  315</span>                      &gt;&gt; 32) * 1000);</div>
<div class="line"><a id="l00316"></a><span class="lineno">  316</span>    }</div>
<div class="line"><a id="l00317"></a><span class="lineno">  317</span> </div>
<div class="line"><a id="l00318"></a><span class="lineno">  318</span>    <span class="comment">/* Seconds: Right shift `ntp` by 32 to get the whole seconds since 1900.</span></div>
<div class="line"><a id="l00319"></a><span class="lineno">  319</span><span class="comment">     * Subtract the difference between the epochs to get a UNIX time, then</span></div>
<div class="line"><a id="l00320"></a><span class="lineno">  320</span><span class="comment">     * multiply by NANO_PER_SEC to get nanoseconds.</span></div>
<div class="line"><a id="l00321"></a><span class="lineno">  321</span><span class="comment">     *</span></div>
<div class="line"><a id="l00322"></a><span class="lineno">  322</span><span class="comment">     * Use the highest bit of ntp to determine (assume) the NTP Era and add</span></div>
<div class="line"><a id="l00323"></a><span class="lineno">  323</span><span class="comment">     * NTP_ROLLOVER if Era 1; this is valid from 1968 to 2104. */</span></div>
<div class="line"><a id="l00324"></a><span class="lineno">  324</span>    <span class="keywordflow">if</span> (ntp &gt;&gt; 63) {</div>
<div class="line"><a id="l00325"></a><span class="lineno">  325</span>        <span class="comment">/* Assume NTP Era 0 */</span></div>
<div class="line"><a id="l00326"></a><span class="lineno">  326</span>        <span class="comment">/* valid for 1968-01-20 03:14:08Z to 2036-02-07 06:28:15Z */</span></div>
<div class="line"><a id="l00327"></a><span class="lineno">  327</span>        yftime-&gt;t += ((ntp &gt;&gt; 32) - NTP_EPOCH_TO_UNIX_EPOCH) * NANO_PER_SEC;</div>
<div class="line"><a id="l00328"></a><span class="lineno">  328</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00329"></a><span class="lineno">  329</span>        <span class="comment">/* Assume NTP Era 1 */</span></div>
<div class="line"><a id="l00330"></a><span class="lineno">  330</span>        <span class="comment">/* valid for 2036-02-07 06:28:16Z to 2104-02-26 09:42:23Z */</span></div>
<div class="line"><a id="l00331"></a><span class="lineno">  331</span>        yftime-&gt;t += (((ntp &gt;&gt; 32) + NTP_ROLLOVER - NTP_EPOCH_TO_UNIX_EPOCH)</div>
<div class="line"><a id="l00332"></a><span class="lineno">  332</span>                      * NANO_PER_SEC);</div>
<div class="line"><a id="l00333"></a><span class="lineno">  333</span>    }</div>
<div class="line"><a id="l00334"></a><span class="lineno">  334</span>}</div>
<div class="line"><a id="l00335"></a><span class="lineno">  335</span> </div>
<div class="line"><a id="l00340"></a><span class="lineno">  340</span><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line"><a id="l00341"></a><span class="lineno">  341</span>yfTimeFromSeconds(</div>
<div class="line"><a id="l00342"></a><span class="lineno">  342</span>    <a class="code hl_struct" href="structyf_time__st.html">yfTime_t</a>       *yftime,</div>
<div class="line"><a id="l00343"></a><span class="lineno">  343</span>    <span class="keyword">const</span> uint64_t  epoch_sec)</div>
<div class="line"><a id="l00344"></a><span class="lineno">  344</span>{</div>
<div class="line"><a id="l00345"></a><span class="lineno">  345</span>    yftime-&gt;t = UINT64_C(1000000000) * epoch_sec;</div>
<div class="line"><a id="l00346"></a><span class="lineno">  346</span>}</div>
<div class="line"><a id="l00347"></a><span class="lineno">  347</span> </div>
<div class="line"><a id="l00352"></a><span class="lineno">  352</span><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line"><a id="l00353"></a><span class="lineno">  353</span>yfTimeFromTimespec(</div>
<div class="line"><a id="l00354"></a><span class="lineno">  354</span>    <a class="code hl_struct" href="structyf_time__st.html">yfTime_t</a>              *yftime,</div>
<div class="line"><a id="l00355"></a><span class="lineno">  355</span>    <span class="keyword">const</span> <span class="keyword">struct</span> timespec *tspec)</div>
<div class="line"><a id="l00356"></a><span class="lineno">  356</span>{</div>
<div class="line"><a id="l00357"></a><span class="lineno">  357</span>    yftime-&gt;t = UINT64_C(1000000000) * tspec-&gt;tv_sec + tspec-&gt;tv_nsec;</div>
<div class="line"><a id="l00358"></a><span class="lineno">  358</span>}</div>
<div class="line"><a id="l00359"></a><span class="lineno">  359</span> </div>
<div class="line"><a id="l00364"></a><span class="lineno">  364</span><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line"><a id="l00365"></a><span class="lineno">  365</span>yfTimeFromTimespec32(</div>
<div class="line"><a id="l00366"></a><span class="lineno">  366</span>    <a class="code hl_struct" href="structyf_time__st.html">yfTime_t</a>              *yftime,</div>
<div class="line"><a id="l00367"></a><span class="lineno">  367</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structyf__timespec32__st.html">yf_timespec32_t</a> *yfspec32)</div>
<div class="line"><a id="l00368"></a><span class="lineno">  368</span>{</div>
<div class="line"><a id="l00369"></a><span class="lineno">  369</span>    yftime-&gt;t = UINT64_C(1000000000) * yfspec32-&gt;tv_sec + yfspec32-&gt;tv_frac;</div>
<div class="line"><a id="l00370"></a><span class="lineno">  370</span>}</div>
<div class="line"><a id="l00371"></a><span class="lineno">  371</span> </div>
<div class="line"><a id="l00376"></a><span class="lineno">  376</span><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line"><a id="l00377"></a><span class="lineno">  377</span>yfTimeFromTimeval(</div>
<div class="line"><a id="l00378"></a><span class="lineno">  378</span>    <a class="code hl_struct" href="structyf_time__st.html">yfTime_t</a>             *yftime,</div>
<div class="line"><a id="l00379"></a><span class="lineno">  379</span>    <span class="keyword">const</span> <span class="keyword">struct</span> timeval *tval)</div>
<div class="line"><a id="l00380"></a><span class="lineno">  380</span>{</div>
<div class="line"><a id="l00381"></a><span class="lineno">  381</span>    yftime-&gt;t = (UINT64_C(1000000000) * tval-&gt;tv_sec</div>
<div class="line"><a id="l00382"></a><span class="lineno">  382</span>                 + UINT64_C(1000) * tval-&gt;tv_usec);</div>
<div class="line"><a id="l00383"></a><span class="lineno">  383</span>}</div>
<div class="line"><a id="l00384"></a><span class="lineno">  384</span> </div>
<div class="line"><a id="l00389"></a><span class="lineno">  389</span><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line"><a id="l00390"></a><span class="lineno">  390</span>yfTimeFromTimeval32(</div>
<div class="line"><a id="l00391"></a><span class="lineno">  391</span>    <a class="code hl_struct" href="structyf_time__st.html">yfTime_t</a>              *yftime,</div>
<div class="line"><a id="l00392"></a><span class="lineno">  392</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structyf__timespec32__st.html">yf_timespec32_t</a> *yfval32)</div>
<div class="line"><a id="l00393"></a><span class="lineno">  393</span>{</div>
<div class="line"><a id="l00394"></a><span class="lineno">  394</span>    yftime-&gt;t = (UINT64_C(1000000000) * yfval32-&gt;tv_sec</div>
<div class="line"><a id="l00395"></a><span class="lineno">  395</span>                 + UINT64_C(1000) * yfval32-&gt;tv_frac);</div>
<div class="line"><a id="l00396"></a><span class="lineno">  396</span>}</div>
<div class="line"><a id="l00397"></a><span class="lineno">  397</span> </div>
<div class="line"><a id="l00402"></a><span class="lineno">  402</span><span class="keyword">static</span> <span class="keyword">inline</span> gboolean</div>
<div class="line"><a id="l00403"></a><span class="lineno">  403</span>yfTimeCheckElapsed(</div>
<div class="line"><a id="l00404"></a><span class="lineno">  404</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structyf_time__st.html">yfTime_t</a>      later_time,</div>
<div class="line"><a id="l00405"></a><span class="lineno">  405</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structyf_time__st.html">yfTime_t</a>      earlier_time,</div>
<div class="line"><a id="l00406"></a><span class="lineno">  406</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structyf_diff_time__st.html">yfDiffTime_t</a>  elapsed)</div>
<div class="line"><a id="l00407"></a><span class="lineno">  407</span>{</div>
<div class="line"><a id="l00408"></a><span class="lineno">  408</span>    <span class="keywordflow">return</span> (later_time.t &gt; earlier_time.t + elapsed.d);</div>
<div class="line"><a id="l00409"></a><span class="lineno">  409</span>}</div>
<div class="line"><a id="l00410"></a><span class="lineno">  410</span> </div>
<div class="line"><a id="l00414"></a><span class="lineno">  414</span><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line"><a id="l00415"></a><span class="lineno">  415</span>yfTimeNow(</div>
<div class="line"><a id="l00416"></a><span class="lineno">  416</span>    <a class="code hl_struct" href="structyf_time__st.html">yfTime_t</a>  *yftime)</div>
<div class="line"><a id="l00417"></a><span class="lineno">  417</span>{</div>
<div class="line"><a id="l00418"></a><span class="lineno">  418</span>    <span class="keyword">struct </span>timeval ct;</div>
<div class="line"><a id="l00419"></a><span class="lineno">  419</span> </div>
<div class="line"><a id="l00420"></a><span class="lineno">  420</span>    gettimeofday(&amp;ct, NULL);</div>
<div class="line"><a id="l00421"></a><span class="lineno">  421</span>    yfTimeFromTimeval(yftime, &amp;ct);</div>
<div class="line"><a id="l00422"></a><span class="lineno">  422</span>}</div>
<div class="line"><a id="l00423"></a><span class="lineno">  423</span> </div>
<div class="line"><a id="l00424"></a><span class="lineno">  424</span> </div>
<div class="line"><a id="l00429"></a><span class="lineno">  429</span><span class="keyword">static</span> <span class="keyword">inline</span> uint64_t</div>
<div class="line"><a id="l00430"></a><span class="lineno">  430</span>yfTimeToMicro(</div>
<div class="line"><a id="l00431"></a><span class="lineno">  431</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structyf_time__st.html">yfTime_t</a>  yftime)</div>
<div class="line"><a id="l00432"></a><span class="lineno">  432</span>{</div>
<div class="line"><a id="l00433"></a><span class="lineno">  433</span>    <span class="keyword">const</span> uint64_t divisor = UINT64_C(1000);</div>
<div class="line"><a id="l00434"></a><span class="lineno">  434</span> </div>
<div class="line"><a id="l00435"></a><span class="lineno">  435</span>    <span class="keywordflow">return</span> yftime.t / divisor;</div>
<div class="line"><a id="l00436"></a><span class="lineno">  436</span>}</div>
<div class="line"><a id="l00437"></a><span class="lineno">  437</span> </div>
<div class="line"><a id="l00442"></a><span class="lineno">  442</span><span class="keyword">static</span> <span class="keyword">inline</span> uint64_t</div>
<div class="line"><a id="l00443"></a><span class="lineno">  443</span>yfTimeToMilli(</div>
<div class="line"><a id="l00444"></a><span class="lineno">  444</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structyf_time__st.html">yfTime_t</a>  yftime)</div>
<div class="line"><a id="l00445"></a><span class="lineno">  445</span>{</div>
<div class="line"><a id="l00446"></a><span class="lineno">  446</span>    <span class="keyword">const</span> uint64_t divisor = UINT64_C(1000000);</div>
<div class="line"><a id="l00447"></a><span class="lineno">  447</span> </div>
<div class="line"><a id="l00448"></a><span class="lineno">  448</span>    <span class="keywordflow">return</span> yftime.t / divisor;</div>
<div class="line"><a id="l00449"></a><span class="lineno">  449</span>}</div>
<div class="line"><a id="l00450"></a><span class="lineno">  450</span> </div>
<div class="line"><a id="l00455"></a><span class="lineno">  455</span><span class="keyword">static</span> <span class="keyword">inline</span> uint64_t</div>
<div class="line"><a id="l00456"></a><span class="lineno">  456</span>yfTimeToNano(</div>
<div class="line"><a id="l00457"></a><span class="lineno">  457</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structyf_time__st.html">yfTime_t</a>  yftime)</div>
<div class="line"><a id="l00458"></a><span class="lineno">  458</span>{</div>
<div class="line"><a id="l00459"></a><span class="lineno">  459</span>    <span class="keywordflow">return</span> yftime.t;</div>
<div class="line"><a id="l00460"></a><span class="lineno">  460</span>}</div>
<div class="line"><a id="l00461"></a><span class="lineno">  461</span> </div>
<div class="line"><a id="l00469"></a><span class="lineno">  469</span><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line"><a id="l00470"></a><span class="lineno">  470</span>yfTimeToNTP(</div>
<div class="line"><a id="l00471"></a><span class="lineno">  471</span>    uint64_t       *ntp,</div>
<div class="line"><a id="l00472"></a><span class="lineno">  472</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structyf_time__st.html">yfTime_t</a>  yftime)</div>
<div class="line"><a id="l00473"></a><span class="lineno">  473</span>{</div>
<div class="line"><a id="l00474"></a><span class="lineno">  474</span>    <span class="comment">/* The number of seconds between the NTP epoch (Jan 1, 1900) and the UNIX</span></div>
<div class="line"><a id="l00475"></a><span class="lineno">  475</span><span class="comment">     * epoch (Jan 1, 1970).  Seventy 365-day years plus 17 leap days, at 86400</span></div>
<div class="line"><a id="l00476"></a><span class="lineno">  476</span><span class="comment">     * sec/day: ((70 * 365 + 17) * 86400) */</span></div>
<div class="line"><a id="l00477"></a><span class="lineno">  477</span>    <span class="keyword">const</span> uint64_t NTP_EPOCH_TO_UNIX_EPOCH = UINT64_C(0x83AA7E80);</div>
<div class="line"><a id="l00478"></a><span class="lineno">  478</span>    <span class="comment">/* Seconds and fractional-seconds divisor */</span></div>
<div class="line"><a id="l00479"></a><span class="lineno">  479</span>    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> divisor = 1000000000LL;</div>
<div class="line"><a id="l00480"></a><span class="lineno">  480</span>    <span class="comment">/* seconds */</span></div>
<div class="line"><a id="l00481"></a><span class="lineno">  481</span>    lldiv_t split = lldiv(yftime.t, divisor);</div>
<div class="line"><a id="l00482"></a><span class="lineno">  482</span>    uint64_t sec;</div>
<div class="line"><a id="l00483"></a><span class="lineno">  483</span>    uint64_t frac;</div>
<div class="line"><a id="l00484"></a><span class="lineno">  484</span> </div>
<div class="line"><a id="l00485"></a><span class="lineno">  485</span>    <span class="comment">/* Adjust seconds for the difference in epochs.  When NTP rolls over in</span></div>
<div class="line"><a id="l00486"></a><span class="lineno">  486</span><span class="comment">     * 2036, sec will be &gt; UINT32_MAX, but those are chopped off when the &lt;&lt;32</span></div>
<div class="line"><a id="l00487"></a><span class="lineno">  487</span><span class="comment">     * is applied. */</span></div>
<div class="line"><a id="l00488"></a><span class="lineno">  488</span>    sec = (uint64_t)split.quot + NTP_EPOCH_TO_UNIX_EPOCH;</div>
<div class="line"><a id="l00489"></a><span class="lineno">  489</span> </div>
<div class="line"><a id="l00490"></a><span class="lineno">  490</span>    <span class="comment">/* Divide number of nanoseconds by 1e9 to get a fractional second, then</span></div>
<div class="line"><a id="l00491"></a><span class="lineno">  491</span><span class="comment">     * multiply by 2^32.  Do those in the reverse order and use shift for the</span></div>
<div class="line"><a id="l00492"></a><span class="lineno">  492</span><span class="comment">     * multiplication.  */</span></div>
<div class="line"><a id="l00493"></a><span class="lineno">  493</span>    frac = (((uint64_t)split.rem) &lt;&lt; UINT64_C(32)) / divisor;</div>
<div class="line"><a id="l00494"></a><span class="lineno">  494</span> </div>
<div class="line"><a id="l00495"></a><span class="lineno">  495</span>    *ntp = ((sec &lt;&lt; UINT64_C(32)) | frac);</div>
<div class="line"><a id="l00496"></a><span class="lineno">  496</span>}</div>
<div class="line"><a id="l00497"></a><span class="lineno">  497</span> </div>
<div class="line"><a id="l00502"></a><span class="lineno">  502</span><span class="keyword">static</span> <span class="keyword">inline</span> uint64_t</div>
<div class="line"><a id="l00503"></a><span class="lineno">  503</span>yfTimeToSeconds(</div>
<div class="line"><a id="l00504"></a><span class="lineno">  504</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structyf_time__st.html">yfTime_t</a>  yftime)</div>
<div class="line"><a id="l00505"></a><span class="lineno">  505</span>{</div>
<div class="line"><a id="l00506"></a><span class="lineno">  506</span>    <span class="keyword">const</span> uint64_t divisor = UINT64_C(1000000000);</div>
<div class="line"><a id="l00507"></a><span class="lineno">  507</span> </div>
<div class="line"><a id="l00508"></a><span class="lineno">  508</span>    <span class="keywordflow">return</span> yftime.t / divisor;</div>
<div class="line"><a id="l00509"></a><span class="lineno">  509</span>}</div>
<div class="line"><a id="l00510"></a><span class="lineno">  510</span> </div>
<div class="line"><a id="l00515"></a><span class="lineno">  515</span><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line"><a id="l00516"></a><span class="lineno">  516</span>yfTimeToTimemilli(</div>
<div class="line"><a id="l00517"></a><span class="lineno">  517</span>    <a class="code hl_struct" href="structyf__time__milli__st.html">yf_time_milli_t</a>    *tmilli,</div>
<div class="line"><a id="l00518"></a><span class="lineno">  518</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structyf_time__st.html">yfTime_t</a>      yftime)</div>
<div class="line"><a id="l00519"></a><span class="lineno">  519</span>{</div>
<div class="line"><a id="l00520"></a><span class="lineno">  520</span>    <span class="comment">/* convert epoch nanosec to epoch millisec, then split into seconds and</span></div>
<div class="line"><a id="l00521"></a><span class="lineno">  521</span><span class="comment">     * fractional seconds */</span></div>
<div class="line"><a id="l00522"></a><span class="lineno">  522</span>    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> nsec_per_msec = 1000000LL;</div>
<div class="line"><a id="l00523"></a><span class="lineno">  523</span>    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> msec_per_sec = 1000LL;</div>
<div class="line"><a id="l00524"></a><span class="lineno">  524</span>    lldiv_t sec = lldiv((yftime.t / nsec_per_msec), msec_per_sec);</div>
<div class="line"><a id="l00525"></a><span class="lineno">  525</span> </div>
<div class="line"><a id="l00526"></a><span class="lineno">  526</span>    tmilli-&gt;tv_sec = sec.quot;</div>
<div class="line"><a id="l00527"></a><span class="lineno">  527</span>    tmilli-&gt;tv_msec = sec.rem;</div>
<div class="line"><a id="l00528"></a><span class="lineno">  528</span>}</div>
<div class="line"><a id="l00529"></a><span class="lineno">  529</span> </div>
<div class="line"><a id="l00534"></a><span class="lineno">  534</span><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line"><a id="l00535"></a><span class="lineno">  535</span>yfTimeToTimespec(</div>
<div class="line"><a id="l00536"></a><span class="lineno">  536</span>    <span class="keyword">struct</span> timespec       *tspec,</div>
<div class="line"><a id="l00537"></a><span class="lineno">  537</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structyf_time__st.html">yfTime_t</a>         yftime)</div>
<div class="line"><a id="l00538"></a><span class="lineno">  538</span>{</div>
<div class="line"><a id="l00539"></a><span class="lineno">  539</span>    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> divisor = 1000000000LL;</div>
<div class="line"><a id="l00540"></a><span class="lineno">  540</span>    lldiv_t sec = lldiv(yftime.t, divisor);</div>
<div class="line"><a id="l00541"></a><span class="lineno">  541</span> </div>
<div class="line"><a id="l00542"></a><span class="lineno">  542</span>    tspec-&gt;tv_sec = sec.quot;</div>
<div class="line"><a id="l00543"></a><span class="lineno">  543</span>    tspec-&gt;tv_nsec = sec.rem;</div>
<div class="line"><a id="l00544"></a><span class="lineno">  544</span>}</div>
<div class="line"><a id="l00545"></a><span class="lineno">  545</span> </div>
<div class="line"><a id="l00551"></a><span class="lineno">  551</span><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line"><a id="l00552"></a><span class="lineno">  552</span>yfTimeToTimespec32(</div>
<div class="line"><a id="l00553"></a><span class="lineno">  553</span>    <a class="code hl_struct" href="structyf__timespec32__st.html">yf_timespec32_t</a>       *yfspec32,</div>
<div class="line"><a id="l00554"></a><span class="lineno">  554</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structyf_time__st.html">yfTime_t</a>         yftime)</div>
<div class="line"><a id="l00555"></a><span class="lineno">  555</span>{</div>
<div class="line"><a id="l00556"></a><span class="lineno">  556</span>    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> divisor = 1000000000LL;</div>
<div class="line"><a id="l00557"></a><span class="lineno">  557</span>    lldiv_t sec = lldiv(yftime.t, divisor);</div>
<div class="line"><a id="l00558"></a><span class="lineno">  558</span> </div>
<div class="line"><a id="l00559"></a><span class="lineno">  559</span>    yfspec32-&gt;tv_sec = sec.quot;</div>
<div class="line"><a id="l00560"></a><span class="lineno">  560</span>    yfspec32-&gt;tv_frac = sec.rem;</div>
<div class="line"><a id="l00561"></a><span class="lineno">  561</span>}</div>
<div class="line"><a id="l00562"></a><span class="lineno">  562</span> </div>
<div class="line"><a id="l00567"></a><span class="lineno">  567</span><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line"><a id="l00568"></a><span class="lineno">  568</span>yfTimeToTimeval(</div>
<div class="line"><a id="l00569"></a><span class="lineno">  569</span>    <span class="keyword">struct</span> timeval       *tval,</div>
<div class="line"><a id="l00570"></a><span class="lineno">  570</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structyf_time__st.html">yfTime_t</a>        yftime)</div>
<div class="line"><a id="l00571"></a><span class="lineno">  571</span>{</div>
<div class="line"><a id="l00572"></a><span class="lineno">  572</span>    <span class="comment">/* convert epoch nanosec to epoch microsec, then split into seconds and</span></div>
<div class="line"><a id="l00573"></a><span class="lineno">  573</span><span class="comment">     * fractional seconds */</span></div>
<div class="line"><a id="l00574"></a><span class="lineno">  574</span>    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> nsec_per_usec = 1000LL;</div>
<div class="line"><a id="l00575"></a><span class="lineno">  575</span>    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> usec_per_sec = 1000000LL;</div>
<div class="line"><a id="l00576"></a><span class="lineno">  576</span>    lldiv_t sec = lldiv((yftime.t / nsec_per_usec), usec_per_sec);</div>
<div class="line"><a id="l00577"></a><span class="lineno">  577</span> </div>
<div class="line"><a id="l00578"></a><span class="lineno">  578</span>    tval-&gt;tv_sec = sec.quot;</div>
<div class="line"><a id="l00579"></a><span class="lineno">  579</span>    tval-&gt;tv_usec = sec.rem;</div>
<div class="line"><a id="l00580"></a><span class="lineno">  580</span>}</div>
<div class="line"><a id="l00581"></a><span class="lineno">  581</span> </div>
<div class="line"><a id="l00587"></a><span class="lineno">  587</span><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line"><a id="l00588"></a><span class="lineno">  588</span>yfTimeToTimeval32(</div>
<div class="line"><a id="l00589"></a><span class="lineno">  589</span>    <a class="code hl_struct" href="structyf__timespec32__st.html">yf_timespec32_t</a>       *yfval32,</div>
<div class="line"><a id="l00590"></a><span class="lineno">  590</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structyf_time__st.html">yfTime_t</a>         yftime)</div>
<div class="line"><a id="l00591"></a><span class="lineno">  591</span>{</div>
<div class="line"><a id="l00592"></a><span class="lineno">  592</span>    <span class="comment">/* convert epoch nanosec to epoch microsec, then split into seconds and</span></div>
<div class="line"><a id="l00593"></a><span class="lineno">  593</span><span class="comment">     * fractional seconds */</span></div>
<div class="line"><a id="l00594"></a><span class="lineno">  594</span>    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> nsec_per_usec = 1000LL;</div>
<div class="line"><a id="l00595"></a><span class="lineno">  595</span>    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> usec_per_sec = 1000000LL;</div>
<div class="line"><a id="l00596"></a><span class="lineno">  596</span>    lldiv_t sec = lldiv((yftime.t / nsec_per_usec), usec_per_sec);</div>
<div class="line"><a id="l00597"></a><span class="lineno">  597</span> </div>
<div class="line"><a id="l00598"></a><span class="lineno">  598</span>    yfval32-&gt;tv_sec = sec.quot;</div>
<div class="line"><a id="l00599"></a><span class="lineno">  599</span>    yfval32-&gt;tv_frac = sec.rem;</div>
<div class="line"><a id="l00600"></a><span class="lineno">  600</span>}</div>
<div class="line"><a id="l00601"></a><span class="lineno">  601</span> </div>
<div class="line"><a id="l00602"></a><span class="lineno">  602</span> </div>
<div class="line"><a id="l00603"></a><span class="lineno">  603</span> </div>
<div class="line"><a id="l00604"></a><span class="lineno">  604</span><span class="comment">/*</span></div>
<div class="line"><a id="l00605"></a><span class="lineno">  605</span><span class="comment"> *    *********************************************************************</span></div>
<div class="line"><a id="l00606"></a><span class="lineno">  606</span><span class="comment"> *</span></div>
<div class="line"><a id="l00607"></a><span class="lineno">  607</span><span class="comment"> *    Functions / Macros for yfDiffTime_t</span></div>
<div class="line"><a id="l00608"></a><span class="lineno">  608</span><span class="comment"> *</span></div>
<div class="line"><a id="l00609"></a><span class="lineno">  609</span><span class="comment"> *    *********************************************************************</span></div>
<div class="line"><a id="l00610"></a><span class="lineno">  610</span><span class="comment"> */</span></div>
<div class="line"><a id="l00611"></a><span class="lineno">  611</span> </div>
<div class="line"><a id="l00615"></a><span class="lineno">  615</span><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line"><a id="l00616"></a><span class="lineno">  616</span>yfDiffTimeClear(</div>
<div class="line"><a id="l00617"></a><span class="lineno">  617</span>    <a class="code hl_struct" href="structyf_diff_time__st.html">yfDiffTime_t</a> *yfdifftime)</div>
<div class="line"><a id="l00618"></a><span class="lineno">  618</span>{</div>
<div class="line"><a id="l00619"></a><span class="lineno">  619</span>    yfdifftime-&gt;d = 0;</div>
<div class="line"><a id="l00620"></a><span class="lineno">  620</span>}</div>
<div class="line"><a id="l00621"></a><span class="lineno">  621</span> </div>
<div class="line"><a id="l00625"></a><span class="lineno">  625</span><span class="keyword">static</span> <span class="keyword">inline</span> gboolean</div>
<div class="line"><a id="l00626"></a><span class="lineno">  626</span>yfDiffTimeIsSet(</div>
<div class="line"><a id="l00627"></a><span class="lineno">  627</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structyf_diff_time__st.html">yfDiffTime_t</a>  yfdifftime)</div>
<div class="line"><a id="l00628"></a><span class="lineno">  628</span>{</div>
<div class="line"><a id="l00629"></a><span class="lineno">  629</span>    <span class="keywordflow">return</span> (0 != yfdifftime.d);</div>
<div class="line"><a id="l00630"></a><span class="lineno">  630</span>}</div>
<div class="line"><a id="l00631"></a><span class="lineno">  631</span> </div>
<div class="line"><a id="l00640"></a><span class="lineno">  640</span><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line"><a id="l00641"></a><span class="lineno">  641</span>yfDiffTimeAdd(</div>
<div class="line"><a id="l00642"></a><span class="lineno">  642</span>    <a class="code hl_struct" href="structyf_diff_time__st.html">yfDiffTime_t</a>        *yfdiff_new,</div>
<div class="line"><a id="l00643"></a><span class="lineno">  643</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structyf_diff_time__st.html">yfDiffTime_t</a>   yfdiff_old,</div>
<div class="line"><a id="l00644"></a><span class="lineno">  644</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structyf_diff_time__st.html">yfDiffTime_t</a>   yfdiff_addend)</div>
<div class="line"><a id="l00645"></a><span class="lineno">  645</span>{</div>
<div class="line"><a id="l00646"></a><span class="lineno">  646</span>    yfdiff_new-&gt;d = yfdiff_old.d + yfdiff_addend.d;</div>
<div class="line"><a id="l00647"></a><span class="lineno">  647</span>}</div>
<div class="line"><a id="l00648"></a><span class="lineno">  648</span> </div>
<div class="line"><a id="l00659"></a><span class="lineno">  659</span><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line"><a id="l00660"></a><span class="lineno">  660</span>yfDiffTimeSub(</div>
<div class="line"><a id="l00661"></a><span class="lineno">  661</span>    <a class="code hl_struct" href="structyf_diff_time__st.html">yfDiffTime_t</a>        *yfdiff_new,</div>
<div class="line"><a id="l00662"></a><span class="lineno">  662</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structyf_diff_time__st.html">yfDiffTime_t</a>   yfdiff_old,</div>
<div class="line"><a id="l00663"></a><span class="lineno">  663</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structyf_diff_time__st.html">yfDiffTime_t</a>   yfdiff_subtrahend)</div>
<div class="line"><a id="l00664"></a><span class="lineno">  664</span>{</div>
<div class="line"><a id="l00665"></a><span class="lineno">  665</span>    yfdiff_new-&gt;d = yfdiff_old.d - yfdiff_subtrahend.d;</div>
<div class="line"><a id="l00666"></a><span class="lineno">  666</span>}</div>
<div class="line"><a id="l00667"></a><span class="lineno">  667</span> </div>
<div class="line"><a id="l00675"></a><span class="lineno">  675</span><span class="preprocessor">#define yfDiffTimeCmpOp(yfdiff_a, yfdiff_b, oper_)      \</span></div>
<div class="line"><a id="l00676"></a><span class="lineno">  676</span><span class="preprocessor">    ((yfdiff_a).d oper_ (yfdiff_b).d)</span></div>
<div class="line"><a id="l00677"></a><span class="lineno">  677</span> </div>
<div class="line"><a id="l00682"></a><span class="lineno">  682</span><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line"><a id="l00683"></a><span class="lineno">  683</span>yfDiffTimeFromMicro(</div>
<div class="line"><a id="l00684"></a><span class="lineno">  684</span>    <a class="code hl_struct" href="structyf_diff_time__st.html">yfDiffTime_t</a>   *yfdifftime,</div>
<div class="line"><a id="l00685"></a><span class="lineno">  685</span>    <span class="keyword">const</span> int64_t   diff_usec)</div>
<div class="line"><a id="l00686"></a><span class="lineno">  686</span>{</div>
<div class="line"><a id="l00687"></a><span class="lineno">  687</span>    yfdifftime-&gt;d = INT64_C(1000) * diff_usec;</div>
<div class="line"><a id="l00688"></a><span class="lineno">  688</span>}</div>
<div class="line"><a id="l00689"></a><span class="lineno">  689</span> </div>
<div class="line"><a id="l00694"></a><span class="lineno">  694</span><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line"><a id="l00695"></a><span class="lineno">  695</span>yfDiffTimeFromMilli(</div>
<div class="line"><a id="l00696"></a><span class="lineno">  696</span>    <a class="code hl_struct" href="structyf_diff_time__st.html">yfDiffTime_t</a>   *yfdifftime,</div>
<div class="line"><a id="l00697"></a><span class="lineno">  697</span>    <span class="keyword">const</span> int64_t   diff_msec)</div>
<div class="line"><a id="l00698"></a><span class="lineno">  698</span>{</div>
<div class="line"><a id="l00699"></a><span class="lineno">  699</span>    yfdifftime-&gt;d = INT64_C(1000000) * diff_msec;</div>
<div class="line"><a id="l00700"></a><span class="lineno">  700</span>}</div>
<div class="line"><a id="l00701"></a><span class="lineno">  701</span> </div>
<div class="line"><a id="l00706"></a><span class="lineno">  706</span><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line"><a id="l00707"></a><span class="lineno">  707</span>yfDiffTimeFromSeconds(</div>
<div class="line"><a id="l00708"></a><span class="lineno">  708</span>    <a class="code hl_struct" href="structyf_diff_time__st.html">yfDiffTime_t</a>   *yfdifftime,</div>
<div class="line"><a id="l00709"></a><span class="lineno">  709</span>    <span class="keyword">const</span> int64_t   diff_sec)</div>
<div class="line"><a id="l00710"></a><span class="lineno">  710</span>{</div>
<div class="line"><a id="l00711"></a><span class="lineno">  711</span>    yfdifftime-&gt;d = INT64_C(1000000000) * diff_sec;</div>
<div class="line"><a id="l00712"></a><span class="lineno">  712</span>}</div>
<div class="line"><a id="l00713"></a><span class="lineno">  713</span> </div>
<div class="line"><a id="l00717"></a><span class="lineno">  717</span><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">double</span></div>
<div class="line"><a id="l00718"></a><span class="lineno">  718</span>yfDiffTimeToDouble(</div>
<div class="line"><a id="l00719"></a><span class="lineno">  719</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structyf_diff_time__st.html">yfDiffTime_t</a>  yfdifftime)</div>
<div class="line"><a id="l00720"></a><span class="lineno">  720</span>{</div>
<div class="line"><a id="l00721"></a><span class="lineno">  721</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> divisor = 1e9;</div>
<div class="line"><a id="l00722"></a><span class="lineno">  722</span> </div>
<div class="line"><a id="l00723"></a><span class="lineno">  723</span>    <span class="keywordflow">return</span> (<span class="keywordtype">double</span>)yfdifftime.d / divisor;</div>
<div class="line"><a id="l00724"></a><span class="lineno">  724</span>}</div>
<div class="line"><a id="l00725"></a><span class="lineno">  725</span> </div>
<div class="line"><a id="l00730"></a><span class="lineno">  730</span><span class="keyword">static</span> <span class="keyword">inline</span> int64_t</div>
<div class="line"><a id="l00731"></a><span class="lineno">  731</span>yfDiffTimeToMilli(</div>
<div class="line"><a id="l00732"></a><span class="lineno">  732</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structyf_diff_time__st.html">yfDiffTime_t</a>  yfdifftime)</div>
<div class="line"><a id="l00733"></a><span class="lineno">  733</span>{</div>
<div class="line"><a id="l00734"></a><span class="lineno">  734</span>    <span class="keyword">const</span> int64_t divisor = INT64_C(1000000);</div>
<div class="line"><a id="l00735"></a><span class="lineno">  735</span> </div>
<div class="line"><a id="l00736"></a><span class="lineno">  736</span>    <span class="keywordflow">return</span> yfdifftime.d / divisor;</div>
<div class="line"><a id="l00737"></a><span class="lineno">  737</span>}</div>
<div class="line"><a id="l00738"></a><span class="lineno">  738</span> </div>
<div class="line"><a id="l00743"></a><span class="lineno">  743</span><span class="keyword">static</span> <span class="keyword">inline</span> int64_t</div>
<div class="line"><a id="l00744"></a><span class="lineno">  744</span>yfDiffTimeToMicro(</div>
<div class="line"><a id="l00745"></a><span class="lineno">  745</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structyf_diff_time__st.html">yfDiffTime_t</a>  yfdifftime)</div>
<div class="line"><a id="l00746"></a><span class="lineno">  746</span>{</div>
<div class="line"><a id="l00747"></a><span class="lineno">  747</span>    <span class="keyword">const</span> int64_t divisor = INT64_C(1000);</div>
<div class="line"><a id="l00748"></a><span class="lineno">  748</span> </div>
<div class="line"><a id="l00749"></a><span class="lineno">  749</span>    <span class="keywordflow">return</span> yfdifftime.d / divisor;</div>
<div class="line"><a id="l00750"></a><span class="lineno">  750</span>}</div>
<div class="line"><a id="l00751"></a><span class="lineno">  751</span> </div>
<div class="line"><a id="l00756"></a><span class="lineno">  756</span><span class="keyword">static</span> <span class="keyword">inline</span> int64_t</div>
<div class="line"><a id="l00757"></a><span class="lineno">  757</span>yfDiffTimeToNano(</div>
<div class="line"><a id="l00758"></a><span class="lineno">  758</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structyf_diff_time__st.html">yfDiffTime_t</a>  yfdifftime)</div>
<div class="line"><a id="l00759"></a><span class="lineno">  759</span>{</div>
<div class="line"><a id="l00760"></a><span class="lineno">  760</span>    <span class="keywordflow">return</span> yfdifftime.d;</div>
<div class="line"><a id="l00761"></a><span class="lineno">  761</span>}</div>
<div class="line"><a id="l00762"></a><span class="lineno">  762</span> </div>
<div class="line"><a id="l00767"></a><span class="lineno">  767</span><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line"><a id="l00768"></a><span class="lineno">  768</span>yfDiffTimeToTimemilli(</div>
<div class="line"><a id="l00769"></a><span class="lineno">  769</span>    <a class="code hl_struct" href="structyf__time__milli__st.html">yf_time_milli_t</a>    *tmilli,</div>
<div class="line"><a id="l00770"></a><span class="lineno">  770</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structyf_diff_time__st.html">yfDiffTime_t</a>  yfdifftime)</div>
<div class="line"><a id="l00771"></a><span class="lineno">  771</span>{</div>
<div class="line"><a id="l00772"></a><span class="lineno">  772</span>    <span class="comment">/* convert the nanosec difference to a millisec difference, then split</span></div>
<div class="line"><a id="l00773"></a><span class="lineno">  773</span><span class="comment">     * into seconds and fractional seconds */</span></div>
<div class="line"><a id="l00774"></a><span class="lineno">  774</span>    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> nsec_per_msec = 1000000LL;</div>
<div class="line"><a id="l00775"></a><span class="lineno">  775</span>    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> msec_per_sec = 1000LL;</div>
<div class="line"><a id="l00776"></a><span class="lineno">  776</span>    lldiv_t sec;</div>
<div class="line"><a id="l00777"></a><span class="lineno">  777</span> </div>
<div class="line"><a id="l00778"></a><span class="lineno">  778</span>    sec = lldiv((yfdifftime.d / nsec_per_msec), msec_per_sec);</div>
<div class="line"><a id="l00779"></a><span class="lineno">  779</span> </div>
<div class="line"><a id="l00780"></a><span class="lineno">  780</span>    tmilli-&gt;tv_sec = sec.quot;</div>
<div class="line"><a id="l00781"></a><span class="lineno">  781</span>    tmilli-&gt;tv_msec = sec.rem;</div>
<div class="line"><a id="l00782"></a><span class="lineno">  782</span> </div>
<div class="line"><a id="l00783"></a><span class="lineno">  783</span>}</div>
<div class="line"><a id="l00784"></a><span class="lineno">  784</span> </div>
<div class="line"><a id="l00789"></a><span class="lineno">  789</span><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line"><a id="l00790"></a><span class="lineno">  790</span>yfDiffTimeToTimespec(</div>
<div class="line"><a id="l00791"></a><span class="lineno">  791</span>    <span class="keyword">struct</span> timespec    *tspec,</div>
<div class="line"><a id="l00792"></a><span class="lineno">  792</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structyf_diff_time__st.html">yfDiffTime_t</a>  yfdifftime)</div>
<div class="line"><a id="l00793"></a><span class="lineno">  793</span>{</div>
<div class="line"><a id="l00794"></a><span class="lineno">  794</span>    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> divisor = 1000000000LL;</div>
<div class="line"><a id="l00795"></a><span class="lineno">  795</span>    lldiv_t sec = lldiv(yfdifftime.d, divisor);</div>
<div class="line"><a id="l00796"></a><span class="lineno">  796</span> </div>
<div class="line"><a id="l00797"></a><span class="lineno">  797</span>    tspec-&gt;tv_sec = sec.quot;</div>
<div class="line"><a id="l00798"></a><span class="lineno">  798</span>    tspec-&gt;tv_nsec = sec.rem;</div>
<div class="line"><a id="l00799"></a><span class="lineno">  799</span>}</div>
<div class="line"><a id="l00800"></a><span class="lineno">  800</span> </div>
<div class="line"><a id="l00805"></a><span class="lineno">  805</span><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line"><a id="l00806"></a><span class="lineno">  806</span>yfDiffTimeToTimeval(</div>
<div class="line"><a id="l00807"></a><span class="lineno">  807</span>    <span class="keyword">struct</span> timeval     *tval,</div>
<div class="line"><a id="l00808"></a><span class="lineno">  808</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structyf_diff_time__st.html">yfDiffTime_t</a>  yfdifftime)</div>
<div class="line"><a id="l00809"></a><span class="lineno">  809</span>{</div>
<div class="line"><a id="l00810"></a><span class="lineno">  810</span>    <span class="comment">/* convert the nanosec difference to a microsec difference, then split</span></div>
<div class="line"><a id="l00811"></a><span class="lineno">  811</span><span class="comment">     * into seconds and fractional seconds */</span></div>
<div class="line"><a id="l00812"></a><span class="lineno">  812</span>    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> nsec_per_usec = 1000LL;</div>
<div class="line"><a id="l00813"></a><span class="lineno">  813</span>    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> usec_per_sec = 1000000LL;</div>
<div class="line"><a id="l00814"></a><span class="lineno">  814</span>    lldiv_t sec;</div>
<div class="line"><a id="l00815"></a><span class="lineno">  815</span> </div>
<div class="line"><a id="l00816"></a><span class="lineno">  816</span>    sec = lldiv((yfdifftime.d / nsec_per_usec), usec_per_sec);</div>
<div class="line"><a id="l00817"></a><span class="lineno">  817</span> </div>
<div class="line"><a id="l00818"></a><span class="lineno">  818</span>    tval-&gt;tv_sec = sec.quot;</div>
<div class="line"><a id="l00819"></a><span class="lineno">  819</span>    tval-&gt;tv_usec = sec.rem;</div>
<div class="line"><a id="l00820"></a><span class="lineno">  820</span>}</div>
<div class="line"><a id="l00821"></a><span class="lineno">  821</span> </div>
<div class="line"><a id="l00822"></a><span class="lineno">  822</span><span class="preprocessor">#endif  </span><span class="comment">/* #ifndef _YAF_TIME_H_ */</span><span class="preprocessor"></span></div>
<div class="ttc" id="astructyf__time__milli__st_html"><div class="ttname"><a href="structyf__time__milli__st.html">yf_time_milli_st</a></div><div class="ttdoc">A structure similar to timeval and timespec but which stores seconds and milliseconds.</div><div class="ttdef"><b>Definition</b> yaftime.h:75</div></div>
<div class="ttc" id="astructyf__timespec32__st_html"><div class="ttname"><a href="structyf__timespec32__st.html">yf_timespec32_st</a></div><div class="ttdoc">Some high-performance network cards use a custom 64-bit structure similar to the standard timeval or ...</div><div class="ttdef"><b>Definition</b> yaftime.h:66</div></div>
<div class="ttc" id="astructyf_diff_time__st_html"><div class="ttname"><a href="structyf_diff_time__st.html">yfDiffTime_st</a></div><div class="ttdoc">YAF time difference: represents the difference of two yfTime_t.</div><div class="ttdef"><b>Definition</b> yaftime.h:55</div></div>
<div class="ttc" id="astructyf_time__st_html"><div class="ttname"><a href="structyf_time__st.html">yfTime_st</a></div><div class="ttdoc">YAF timestamp: represents a moment in time.</div><div class="ttdef"><b>Definition</b> yaftime.h:47</div></div>
</div><!-- fragment --></div><!-- contents -->
</body>
</html>

